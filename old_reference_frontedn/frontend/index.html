<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>TeacherAI - AI Teaching Assistant</title>

  <!-- Core Libraries -->
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/simple-datatables@latest"></script>

  <!-- Fonts -->
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">

  <!-- Dark Theme Styles -->
  <link rel="stylesheet" href="styles/dark-theme.css">

  <!-- Tailwind Config -->
  <script>
    tailwind.config = {
      darkMode: 'class',
      theme: {
        extend: {
          fontFamily: {
            sans: ['Inter', 'sans-serif'],
          }
        }
      }
    }
  </script>
</head>
<body class="dark">
  <!-- Sidebar Navigation -->
  <aside class="sidebar">
    <div class="p-6">
      <!-- Logo -->
      <div class="flex items-center gap-3 mb-8">
        <div class="w-8 h-8 bg-gradient-to-br from-blue-500 to-teal-500 rounded-lg flex items-center justify-center">
          <i data-lucide="graduation-cap" class="w-5 h-5 text-white"></i>
        </div>
        <h1 class="text-lg font-semibold text-white">TeacherAI</h1>
      </div>

      <!-- Navigation -->
      <nav class="space-y-1">
        <a href="#dashboard" class="sidebar-item" data-page="dashboard">
          <i data-lucide="layout-dashboard" class="w-5 h-5"></i>
          <span>Dashboard</span>
        </a>
        <a href="#grading-wizard" class="sidebar-item active" data-page="grading-wizard">
          <i data-lucide="sparkles" class="w-5 h-5"></i>
          <span>AI Grading</span>
        </a>
        <a href="#scan-processor" class="sidebar-item" data-page="scan-processor">
          <i data-lucide="scan-line" class="w-5 h-5"></i>
          <span>Scan Processor</span>
        </a>
        <a href="#ai-assistant" class="sidebar-item" data-page="ai-assistant">
          <i data-lucide="bot" class="w-5 h-5"></i>
          <span>AI Assistant</span>
        </a>
        
        <!-- Future Features -->
        <div class="pt-4 pb-2">
          <p class="text-xs font-medium text-gray-500 uppercase tracking-wider px-3">Coming Soon</p>
        </div>
        <a href="#lesson-planner" class="sidebar-item opacity-50 cursor-not-allowed">
          <i data-lucide="calendar" class="w-5 h-5"></i>
          <span>Lesson Planner</span>
        </a>
        <a href="#content-creator" class="sidebar-item opacity-50 cursor-not-allowed">
          <i data-lucide="file-text" class="w-5 h-5"></i>
          <span>Content Creator</span>
        </a>
        <a href="#analytics" class="sidebar-item opacity-50 cursor-not-allowed">
          <i data-lucide="bar-chart-3" class="w-5 h-5"></i>
          <span>Analytics</span>
        </a>
      </nav>
    </div>

    <!-- Footer -->
    <div class="absolute bottom-0 left-0 right-0 p-6 border-t border-gray-800">
      <div class="text-xs text-gray-500 text-center">Â© 2025 TeacherAI</div>
    </div>
  </aside>

  <!-- Top Bar -->
  <header class="top-bar">
    <!-- Breadcrumb -->
    <div class="flex items-center space-x-2 text-sm">
      <span class="text-gray-400">TeacherAI</span>
      <i data-lucide="chevron-right" class="w-4 h-4 text-gray-500"></i>
      <span class="text-white" id="current-page">AI Grading</span>
    </div>

    <!-- Right Side -->
    <div class="flex items-center space-x-4">
      <!-- Notifications -->
      <button class="p-2 hover:bg-gray-800 rounded-lg transition-colors">
        <i data-lucide="bell" class="w-5 h-5 text-gray-400"></i>
      </button>

      <!-- User Profile -->
      <div class="flex items-center space-x-3">
        <div class="w-8 h-8 bg-gradient-to-br from-teal-500 to-blue-600 rounded-full flex items-center justify-center">
          <i data-lucide="user" class="w-4 h-4 text-white"></i>
        </div>
        <span class="text-sm text-gray-300 hidden sm:block">Teacher</span>
        <button class="p-1 hover:bg-gray-800 rounded transition-colors">
          <i data-lucide="chevron-down" class="w-4 h-4 text-gray-400"></i>
        </button>
      </div>
    </div>
  </header>

  <!-- Main Content -->
  <main class="main-content">
    <div id="content">
      <!-- Content will be loaded here -->
    </div>
  </main>

  <!-- Initialize Icons -->
  <script>
    // Initialize Lucide icons
    lucide.createIcons();
    
    // Enhanced page navigation with URL hash support
    document.addEventListener('DOMContentLoaded', () => {
      // Check for hash navigation first
      if (window.location.hash) {
        handleHashNavigation();
      } else {
        // Load grading wizard by default (new primary interface)
        loadPage('grading-wizard');
      }
      
      // Handle navigation clicks
      document.querySelectorAll('[data-page]').forEach(link => {
        link.addEventListener('click', (e) => {
          e.preventDefault();
          const page = e.currentTarget.dataset.page;
          
          // Skip disabled pages
          if (e.currentTarget.classList.contains('opacity-50')) {
            return;
          }
          
          loadPage(page);
        });
      });
      
      // Handle hash changes (for scan processor navigation)
      window.addEventListener('hashchange', handleHashNavigation);
    });

    function handleHashNavigation() {
      const hash = window.location.hash.substring(1); // Remove #
      const [page, params] = hash.split('?');
      const urlParams = new URLSearchParams(params || '');
      
      if (page) {
        loadPage(page, urlParams);
      }
    }

    function loadPage(page, urlParams = new URLSearchParams()) {
      // Update active state
      document.querySelectorAll('.sidebar-item').forEach(item => {
        item.classList.remove('active');
      });
      const pageElement = document.querySelector(`[data-page="${page}"]`);
      if (pageElement) {
        pageElement.classList.add('active');
      }
      
      // Update breadcrumb
      const pageNames = {
        'dashboard': 'Dashboard',
        'grading-wizard': 'AI Grading',
        'grading-hub-legacy': 'Grading Hub (Legacy)',
        'scan-processor': 'Scan Processor',
        'scan-processor-legacy': 'Scan Processor (Legacy)',
        'ai-assistant': 'AI Assistant'
      };
      document.getElementById('current-page').textContent = pageNames[page] || page;
      
      // Load page content with context
      if (page === 'grading-wizard') {
        // Load grading wizard
        import('./pages/grading-wizard/index.js').then(module => {
          console.log('ðŸ§™â€â™‚ï¸ Loading Grading Wizard...');
          module.default(); // Initialize the wizard
        }).catch(error => {
          console.error('Failed to load Grading Wizard:', error);
          document.getElementById('content').innerHTML = `
            <div class="error-state">
              <h2>Failed to load Grading Wizard</h2>
              <p>Error: ${error.message}</p>
            </div>
          `;
        });
      } else if (page === 'scan-processor') {
        document.getElementById('content').innerHTML = '<div id="scan-processor-container"></div>';
        import('./pages/scan-processor/index.js').then(module => {
          window.scanProcessor = new module.default();
          window.scanProcessor.init();
        });
      } else if (page === 'dashboard') {
        renderDashboard();
      } else if (page === 'ai-assistant') {
        import('./pages/ai-assistant.js').then(module => {
          module.renderAIAssistant(document.getElementById('content'));
        });
      }
    }
    
    // Make loadPage available globally
    window.loadPage = loadPage;

    function renderDashboard() {
      const content = document.getElementById('content');
      content.innerHTML = `
        <div class="space-y-6">
          <div>
            <h1 class="text-2xl font-bold text-white mb-2">Welcome back!</h1>
            <p class="text-gray-400">Here's what's happening with your teaching today.</p>
          </div>
          
          <div class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="card">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm text-gray-400">Assignments Graded</p>
                  <p class="text-2xl font-bold text-white">24</p>
                </div>
                <div class="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center">
                  <i data-lucide="clipboard-check" class="w-6 h-6 text-blue-400"></i>
                </div>
              </div>
            </div>
            
            <div class="card">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm text-gray-400">Students</p>
                  <p class="text-2xl font-bold text-white">156</p>
                </div>
                <div class="w-12 h-12 bg-green-500/20 rounded-lg flex items-center justify-center">
                  <i data-lucide="users" class="w-6 h-6 text-green-400"></i>
                </div>
              </div>
            </div>
            
            <div class="card">
              <div class="flex items-center justify-between">
                <div>
                  <p class="text-sm text-gray-400">Time Saved</p>
                  <p class="text-2xl font-bold text-white">12h</p>
                </div>
                <div class="w-12 h-12 bg-purple-500/20 rounded-lg flex items-center justify-center">
                  <i data-lucide="clock" class="w-6 h-6 text-purple-400"></i>
                </div>
              </div>
            </div>
          </div>
          
          <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
            <div class="card">
              <h3 class="text-lg font-semibold text-white mb-4">Recent Activity</h3>
              <div class="space-y-3">
                <div class="flex items-center gap-3 p-3 bg-gray-800 rounded-lg">
                  <i data-lucide="clipboard-check" class="w-5 h-5 text-blue-400"></i>
                  <div>
                    <p class="text-sm text-white">Graded Math Quiz</p>
                    <p class="text-xs text-gray-400">2 hours ago</p>
                  </div>
                </div>
                <div class="flex items-center gap-3 p-3 bg-gray-800 rounded-lg">
                  <i data-lucide="file-text" class="w-5 h-5 text-green-400"></i>
                  <div>
                    <p class="text-sm text-white">Created Rubric</p>
                    <p class="text-xs text-gray-400">1 day ago</p>
                  </div>
                </div>
              </div>
            </div>
            
            <div class="card">
              <h3 class="text-lg font-semibold text-white mb-4">Quick Actions</h3>
              <div class="space-y-2">
                <button class="btn btn-primary w-full justify-start" onclick="loadPage('grading-wizard')">
                  <i data-lucide="sparkles" class="w-4 h-4"></i>
                  Start New Grading
                </button>
                <button class="btn btn-secondary w-full justify-start opacity-50 cursor-not-allowed">
                  <i data-lucide="calendar" class="w-4 h-4"></i>
                  Create Lesson Plan
                </button>
                <button class="btn btn-secondary w-full justify-start opacity-50 cursor-not-allowed">
                  <i data-lucide="bar-chart-3" class="w-4 h-4"></i>
                  View Analytics
                </button>
              </div>
            </div>
          </div>
        </div>
      `;
      lucide.createIcons();
    }
  </script>
</body>
</html>
